<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Terraform VirtualBox Provider | markkerry.github.io</title><meta name=keywords content="Terraform,IaC,VirtualBox"><meta name=description content="In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, terra-farm
You can install VirtualBox on Ubuntu using this guide. The main.tf file is configured to use a network adapter called vnetbox1, so you need to ensure it is created and set DHCP Server to Enable.
Install Terraform Let&rsquo;s start by installing Terraform. The following is from the official Terraform documentation:
Add the Terraform gpg key."><meta name=author content="Mark kerry"><link rel=canonical href=https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b9ff4cc257e914dab489bd18086151800e18f91456a5174bf28489210227a659.css integrity="sha256-uf9MwlfpFNq0ib0YCGFRgA4Y+RRWpRdL8oSJIQInplk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://markkerry.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://markkerry.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://markkerry.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://markkerry.github.io/apple-touch-icon.png><link rel=mask-icon href=https://markkerry.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.98.0"><script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config",'')</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZDLE8M8RG"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XZDLE8M8RG",{anonymize_ip:!1})}</script><meta property="og:title" content="Terraform VirtualBox Provider"><meta property="og:description" content="In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, terra-farm
You can install VirtualBox on Ubuntu using this guide. The main.tf file is configured to use a network adapter called vnetbox1, so you need to ensure it is created and set DHCP Server to Enable.
Install Terraform Let&rsquo;s start by installing Terraform. The following is from the official Terraform documentation:
Add the Terraform gpg key."><meta property="og:type" content="article"><meta property="og:url" content="https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/"><meta property="og:image" content="https://markkerry.github.io/images/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-01T10:02:49+00:00"><meta property="article:modified_time" content="2022-05-01T10:02:49+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://markkerry.github.io/images/cover.png"><meta name=twitter:title content="Terraform VirtualBox Provider"><meta name=twitter:description content="In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, terra-farm
You can install VirtualBox on Ubuntu using this guide. The main.tf file is configured to use a network adapter called vnetbox1, so you need to ensure it is created and set DHCP Server to Enable.
Install Terraform Let&rsquo;s start by installing Terraform. The following is from the official Terraform documentation:
Add the Terraform gpg key."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://markkerry.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Terraform VirtualBox Provider","item":"https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Terraform VirtualBox Provider","name":"Terraform VirtualBox Provider","description":"In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, terra-farm\nYou can install VirtualBox on Ubuntu using this guide. The main.tf file is configured to use a network adapter called vnetbox1, so you need to ensure it is created and set DHCP Server to Enable.\nInstall Terraform Let\u0026rsquo;s start by installing Terraform. The following is from the official Terraform documentation:\nAdd the Terraform gpg key.","keywords":["Terraform","IaC","VirtualBox"],"articleBody":"In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, terra-farm\nYou can install VirtualBox on Ubuntu using this guide. The main.tf file is configured to use a network adapter called vnetbox1, so you need to ensure it is created and set DHCP Server to Enable.\nInstall Terraform Let’s start by installing Terraform. The following is from the official Terraform documentation:\nAdd the Terraform gpg key.\ncurl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add - Add the Terraform apt repo\nsudo apt-add-repository \"deb [arch=$(dpkg --print-architecture)] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" Update the apt package index\nsudo apt update Install Terraform\nsudo apt install terraform Verify Terraform is installed with\nterraform --version Install Go We need to install GO in order to install the terra-farm plugin in the next section. Install Go as follows:\nDownload Go\ncurl -fsSL https://go.dev/dl/go1.18.linux-amd64.tar.gz -o ~/Downloads/go1.18.linux-amd64.tar.gz Remove any old installations\nrm -rf /usr/local/go \u0026\u0026 tar -C /usr/local -xzf go1.18.linux-amd64.tar.gz Set the path environment variable\nexport PATH=$PATH:/usr/local/go/bin Verify Go is installed with\ngo version Install terra-farm Provider Now we are ready to install the terra-farm/terraform-provider-virtualbox provider/plugin. Create the following directory which terraform init will search for plugins\nmkdir ~/.terraform.d/plugins Install the VirtualBox provider/plugin.\ngo install github.com/terra-farm/terraform-provider-virtualbox@latest Then copy it to the plugins directory\ncp go/bin/terraform-provider-virtualbox ~/.terraform.d/plugins Create the main.tf File Now it’s time to create the main.tf file. Start by creating a directory for it.\nmkdir ~/terraform-virtualbox \u0026\u0026 cd ~/terraform-virtualbox Create the file using vim\nvim main.tf The main.tf will need to look as below. This will provision two virtual machines called node-01 and node-02. Both will have 2 vCpus and 512 MB memory. And the outputs are the IP addresses of the VMs.\nterraform {  required_providers {  virtualbox = {  source = \"terra-farm/virtualbox\"  version = \"0.2.2-alpha.1\"  }  } } resource \"virtualbox_vm\" \"node\" {  count = 2  name = format(\"node-%02d\", count.index + 1)  image = \"https://app.vagrantup.com/ubuntu/boxes/bionic64/versions/20180903.0.0/providers/virtualbox.box\"  cpus = 2  memory = \"512 mib\"   network_adapter {  type = \"hostonly\"  host_interface = \"vboxnet1\"  } } output \"IPAddr\" {  value = element(virtualbox_vm.node.*.network_adapter.0.ipv4_address, 1) } output \"IPAddr_2\" {  value = element(virtualbox_vm.node.*.network_adapter.0.ipv4_address, 2) }  Note: The documentation uses version = \"0.2.1\" but this didn’t work for me. I had to use version = \"0.2.2-aplha.1\"\n Provision the Virtual Machines When writing a new Terraform configuration, we have to initialise the working directory which contains the configuration files.\nterraform init Next create a plan of execution by creating a “state” file. The following command will allow you to preview the changes which will be made to your infrastructure.\nterraform plan As you can see below the resources do not currently exist, so terraform plan has determined they will be created.\nCreate them using the following command:\nterraform apply Type yes to continue. Below states that two resources were added and their IP addresses where returned in the Outputs.\nDo you want to perform these actions? Terraform will perform the actions described above. Only 'yes' will be accepted to approve. Enter a value: yes virtualbox_vm.node[1]: Creating... virtualbox_vm.node[0]: Creating... --- --- --- virtualbox_vm.node[1]: Creation complete after 2m23s [id=b80423eb-0018-4639-a887-796586e20853] virtualbox_vm.node[0]: Creation complete after 2m28s [id=734bef80-2b3d-442b-86d6-14455cd62adf] Apply complete! Resources: 2 added, 0 changed, 0 destroyed. Outputs: IPAddr = \"192.168.57.3\" IPAddr_2 = \"192.168.57.4\" In VirtualBox you we can see node-01 and node-02 virtual machines.\nSince these machine where provisioned using Vagrant images we can logon to them using the default username and password.\nuser: vagrant password: vagrant If I power off a node-01 using the shutdown now command, I can run terraform plan again which will show a change is required as the VM being off does not match the desired state. As you can see below the status should be “running”.\nI can use terraform apply again to power the VM back on again.\nDelete the Virtual Machines We can delete all objects managed by this configuration using the terraform destroy command. Start by viewing what will be deleted:\nterraform plan -destroy Then run the destroy command, typing yes to confirm.\nterraform destroy ","wordCount":"661","inLanguage":"en","image":"https://markkerry.github.io/images/cover.png","datePublished":"2022-05-01T10:02:49Z","dateModified":"2022-05-01T10:02:49Z","author":{"@type":"Person","name":"Mark kerry"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/"},"publisher":{"@type":"Organization","name":"markkerry.github.io","logo":{"@type":"ImageObject","url":"https://markkerry.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://markkerry.github.io/ accesskey=h title="markkerry.github.io (Alt + H)">markkerry.github.io</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://markkerry.github.io/about/ title=About><span>About</span></a></li><li><a href=https://markkerry.github.io/archive title=Archive><span>Archive</span></a></li><li><a href=https://markkerry.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://markkerry.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://markkerry.github.io/posts/>Posts</a></div><h1 class=post-title>Terraform VirtualBox Provider</h1><div class=post-meta>May 1, 2022&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Mark kerry</div></header><figure class=entry-cover><img loading=lazy srcset="https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/images/cover_hu1afbcc504ab2aa39499beb0b6a01732b_62198_360x0_resize_box_3.png 360w ,https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/images/cover_hu1afbcc504ab2aa39499beb0b6a01732b_62198_480x0_resize_box_3.png 480w ,https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/images/cover.png 717w" sizes="(min-width: 768px) 720px, 100vw" src=https://markkerry.github.io/posts/2022/05/terraform-virtualbox-provider/images/cover.png alt width=717 height=338><p>Use Terraform to provision VirtualBox VMs using the terra-farm provider</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#install-terraform aria-label="Install Terraform">Install Terraform</a></li><li><a href=#install-go aria-label="Install Go">Install Go</a></li><li><a href=#install-terra-farm-provider aria-label="Install terra-farm Provider">Install terra-farm Provider</a></li><li><a href=#create-the-maintf-file aria-label="Create the main.tf File">Create the main.tf File</a></li><li><a href=#provision-the-virtual-machines aria-label="Provision the Virtual Machines">Provision the Virtual Machines</a></li><li><a href=#delete-the-virtual-machines aria-label="Delete the Virtual Machines">Delete the Virtual Machines</a></li></ul></div></details></div><div class=post-content><p>In this post I will demonstrate how to deploy 2x Ubuntu Virtual Machines using the Terraform VirtualBox provider, <a href=https://registry.terraform.io/providers/terra-farm/virtualbox/latest/docs>terra-farm</a></p><p>You can install VirtualBox on Ubuntu using <a href=https://markkerry.github.io/posts/2022/02/ubuntu-server-lab/#install-virtualbox-61>this guide</a>. The <code>main.tf</code> file is configured to use a network adapter called <strong>vnetbox1</strong>, so you need to ensure it is created and set <strong>DHCP Server</strong> to <strong>Enable</strong>.</p><p><img loading=lazy src=images/vboxnet1.png alt=vboxnet1></p><h2 id=install-terraform>Install Terraform<a hidden class=anchor aria-hidden=true href=#install-terraform>#</a></h2><p>Let&rsquo;s start by installing Terraform. The following is from the official Terraform documentation:</p><p>Add the Terraform gpg key.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -
</code></pre><p>Add the Terraform apt repo</p><pre tabindex=0><code class=language-terminal data-lang=terminal>sudo apt-add-repository &#34;deb [arch=$(dpkg --print-architecture)] https://apt.releases.hashicorp.com $(lsb_release -cs) main&#34;
</code></pre><p>Update the apt package index</p><pre tabindex=0><code class=language-terminal data-lang=terminal>sudo apt update
</code></pre><p>Install Terraform</p><pre tabindex=0><code class=language-treminal data-lang=treminal>sudo apt install terraform
</code></pre><p>Verify Terraform is installed with</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform --version
</code></pre><h2 id=install-go>Install Go<a hidden class=anchor aria-hidden=true href=#install-go>#</a></h2><p>We need to install GO in order to install the terra-farm plugin in the next section. Install Go as follows:</p><p>Download Go</p><pre tabindex=0><code class=language-terminal data-lang=terminal>curl -fsSL https://go.dev/dl/go1.18.linux-amd64.tar.gz -o ~/Downloads/go1.18.linux-amd64.tar.gz
</code></pre><p>Remove any old installations</p><pre tabindex=0><code class=language-terminal data-lang=terminal>rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.18.linux-amd64.tar.gz
</code></pre><p>Set the path environment variable</p><pre tabindex=0><code class=language-terminal data-lang=terminal>export PATH=$PATH:/usr/local/go/bin
</code></pre><p>Verify Go is installed with</p><pre tabindex=0><code class=language-terminal data-lang=terminal>go version
</code></pre><h2 id=install-terra-farm-provider>Install terra-farm Provider<a hidden class=anchor aria-hidden=true href=#install-terra-farm-provider>#</a></h2><p>Now we are ready to install the terra-farm/terraform-provider-virtualbox provider/plugin. Create the following directory which <code>terraform init</code> will search for plugins</p><pre tabindex=0><code class=language-teminal data-lang=teminal>mkdir ~/.terraform.d/plugins
</code></pre><p>Install the VirtualBox provider/plugin.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>go install github.com/terra-farm/terraform-provider-virtualbox@latest
</code></pre><p>Then copy it to the plugins directory</p><pre tabindex=0><code class=language-terminal data-lang=terminal>cp go/bin/terraform-provider-virtualbox  ~/.terraform.d/plugins
</code></pre><h2 id=create-the-maintf-file>Create the main.tf File<a hidden class=anchor aria-hidden=true href=#create-the-maintf-file>#</a></h2><p>Now it&rsquo;s time to create the <code>main.tf</code> file. Start by creating a directory for it.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>mkdir ~/terraform-virtualbox &amp;&amp; cd ~/terraform-virtualbox
</code></pre><p>Create the file using <code>vim</code></p><pre tabindex=0><code class=language-terminal data-lang=terminal>vim main.tf
</code></pre><p>The <code>main.tf</code> will need to look as below. This will provision two virtual machines called <strong>node-01</strong> and <strong>node-02</strong>. Both will have 2 vCpus and 512 MB memory. And the outputs are the IP addresses of the VMs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#a6e22e>terraform</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>required_providers</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>virtualbox</span> = {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>source</span> = <span style=color:#e6db74>&#34;terra-farm/virtualbox&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>version</span> = <span style=color:#e6db74>&#34;0.2.2-alpha.1&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;virtualbox_vm&#34;</span> <span style=color:#e6db74>&#34;node&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>count</span>     = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>      = format(<span style=color:#e6db74>&#34;node-%02d&#34;</span>, count.<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>image</span>     = <span style=color:#e6db74>&#34;https://app.vagrantup.com/ubuntu/boxes/bionic64/versions/20180903.0.0/providers/virtualbox.box&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>cpus</span>      = <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>memory</span>    = <span style=color:#e6db74>&#34;512 mib&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>network_adapter</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>type</span>           = <span style=color:#e6db74>&#34;hostonly&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>host_interface</span> = <span style=color:#e6db74>&#34;vboxnet1&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;IPAddr&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span> = element(<span style=color:#a6e22e>virtualbox_vm</span>.<span style=color:#a6e22e>node</span>.<span style=color:#f92672>*</span>.<span style=color:#a6e22e>network_adapter</span>.<span style=color:#ae81ff>0</span>.<span style=color:#a6e22e>ipv4_address</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;IPAddr_2&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span> = element(<span style=color:#a6e22e>virtualbox_vm</span>.<span style=color:#a6e22e>node</span>.<span style=color:#f92672>*</span>.<span style=color:#a6e22e>network_adapter</span>.<span style=color:#ae81ff>0</span>.<span style=color:#a6e22e>ipv4_address</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><blockquote><p><em>Note: The documentation uses <code>version = "0.2.1"</code> but this didn&rsquo;t work for me. I had to use <code>version = "0.2.2-aplha.1"</code></em></p></blockquote><h2 id=provision-the-virtual-machines>Provision the Virtual Machines<a hidden class=anchor aria-hidden=true href=#provision-the-virtual-machines>#</a></h2><p>When writing a new Terraform configuration, we have to initialise the working directory which contains the configuration files.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform init
</code></pre><p><img loading=lazy src=images/terraformInit.png alt=terraformInit></p><p>Next create a plan of execution by creating a &ldquo;state&rdquo; file. The following command will allow you to preview the changes which will be made to your infrastructure.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform plan
</code></pre><p>As you can see below the resources do not currently exist, so <code>terraform plan</code> has determined they will be created.</p><p><img loading=lazy src=images/terraformPlan.png alt=terraformPlan></p><p>Create them using the following command:</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform apply
</code></pre><p>Type <code>yes</code> to continue. Below states that two resources were added and their IP addresses where returned in the <strong>Outputs</strong>.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only &#39;yes&#39; will be accepted to approve.

  Enter a value: yes

virtualbox_vm.node[1]: Creating...
virtualbox_vm.node[0]: Creating...

---
---
---

virtualbox_vm.node[1]: Creation complete after 2m23s [id=b80423eb-0018-4639-a887-796586e20853]
virtualbox_vm.node[0]: Creation complete after 2m28s [id=734bef80-2b3d-442b-86d6-14455cd62adf]

Apply complete! Resources: 2 added, 0 changed, 0 destroyed.

Outputs:

IPAddr = &#34;192.168.57.3&#34;
IPAddr_2 = &#34;192.168.57.4&#34;
</code></pre><p>In VirtualBox you we can see <strong>node-01</strong> and <strong>node-02</strong> virtual machines.</p><p><img loading=lazy src=images/nodes.png alt=nodes></p><p>Since these machine where provisioned using Vagrant images we can logon to them using the default username and password.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>user: vagrant
password: vagrant
</code></pre><p><img loading=lazy src=images/login.png alt=login></p><p>If I power off a node-01 using the <code>shutdown now</code> command, I can run <code>terraform plan</code> again which will show a change is required as the VM being off does not match the desired state. As you can see below the status should be &ldquo;running&rdquo;.</p><p><img loading=lazy src=images/terraformPlan2.png alt=terraformPlan2></p><p>I can use <code>terraform apply</code> again to power the VM back on again.</p><h2 id=delete-the-virtual-machines>Delete the Virtual Machines<a hidden class=anchor aria-hidden=true href=#delete-the-virtual-machines>#</a></h2><p>We can delete all objects managed by this configuration using the <code>terraform destroy</code> command. Start by viewing what will be deleted:</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform plan -destroy
</code></pre><p><img loading=lazy src=images/planDestroy.png alt=planDestroy></p><p>Then run the destroy command, typing <code>yes</code> to confirm.</p><pre tabindex=0><code class=language-terminal data-lang=terminal>terraform destroy
</code></pre><p><img loading=lazy src=images/terraformDestroy.png alt=terraformDestroy></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://markkerry.github.io/tags/terraform/>Terraform</a></li><li><a href=https://markkerry.github.io/tags/iac/>IaC</a></li><li><a href=https://markkerry.github.io/tags/virtualbox/>VirtualBox</a></li></ul><nav class=paginav><a class=next href=https://markkerry.github.io/posts/2022/04/windows-cis-with-ansible/><span class=title>Next Page »</span><br><span>Configure Windows Server 2022 with Ansible</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://markkerry.github.io/>markkerry.github.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>