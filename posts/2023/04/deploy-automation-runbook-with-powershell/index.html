<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploy an Azure Automation Runbook With PowerShell | markkerry.github.io</title><meta name=keywords content="Azure,Automation,PowerShell"><meta name=description content="The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the ForEach-Object -Parrallel feature for example, then you will have to use PowerShell 7."><meta name=author content="Mark kerry"><link rel=canonical href=https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://markkerry.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://markkerry.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://markkerry.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://markkerry.github.io/apple-touch-icon.png><link rel=mask-icon href=https://markkerry.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZDLE8M8RG"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XZDLE8M8RG",{anonymize_ip:!1})}</script><meta property="og:title" content="Deploy an Azure Automation Runbook With PowerShell"><meta property="og:description" content="The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the ForEach-Object -Parrallel feature for example, then you will have to use PowerShell 7."><meta property="og:type" content="article"><meta property="og:url" content="https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/"><meta property="og:image" content="https://markkerry.github.io/media/cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-02T12:39:38+00:00"><meta property="article:modified_time" content="2023-04-02T12:39:38+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://markkerry.github.io/media/cover.png"><meta name=twitter:title content="Deploy an Azure Automation Runbook With PowerShell"><meta name=twitter:description content="The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the ForEach-Object -Parrallel feature for example, then you will have to use PowerShell 7."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://markkerry.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Deploy an Azure Automation Runbook With PowerShell","item":"https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploy an Azure Automation Runbook With PowerShell","name":"Deploy an Azure Automation Runbook With PowerShell","description":"The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the ForEach-Object -Parrallel feature for example, then you will have to use PowerShell 7.","keywords":["Azure","Automation","PowerShell"],"articleBody":"The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the ForEach-Object -Parrallel feature for example, then you will have to use PowerShell 7.1 runtime type.\nNOTE: At the time of writing, Microsoft does not support deploying a runbook with PowerShell 7.1 as the runtime type using PowerShell, AZ CLI, ARM or Bicep. To get around this the content of the runbook has to be posted to the automation account using the Invoke-AzRestMethod cmdlet.\nI wonâ€™t go over creating the automation account and will assume it is already created. To create one using PowerShell see Microsoft Docs.\nPowerShell 5.1 Runtime The PowerShell 5.1 runbook can easily be created and imported using a single command. The following assumes the runbook script is in the same directory as the deployment script and the name of the file is assigned to the $scriptName variable. Assign the $runbookName variable the name of the runbook you want to create or deploy to.\n$automationAccount = \"\" $resourceGroup = \"\" $runbookName = \"\" $scriptName = \"\" Import-AzAutomationRunbook ` -AutomationAccountName $automationAccount ` -Name $runbookName ` -Path $PSScriptRoot\\$scriptName ` -Published ` -ResourceGroupName $resourceGroup ` -Type PowerShell Although the above is well documented already, I wanted to keep it in this post as a comparison to doing for PowerShell 7.1 runtime which is not documented by Microsoft.\nPowerShell 7.1 Runtime As mentioned above the process is different and the Invoke-AzRestMethod cmdlet has to be used to publish a PowerShell 7.1 runtime runbook. As the script has to be posted, start by assigning the script content to a variable, create the runbook, then finally importing it. The below gives an example script assigned to the $scriptContent variable.\n$scriptContent = @' # Ensure you do not inherit an AzContext in your runbook try { Disable-AzContextAutosave -Scope Process | Out-Null Write-Output \"Logging in to Azure...\" Connect-AzAccount -Identity | Out-Null } catch { Write-Error -Message $_.Exception throw $_.Exception } # Rest of script goes here... '@ $automationAccount = \"\" $resourceGroup = \"\" $runbookName = \"\" $location = \"\" Invoke-AzRestMethod -Method \"PUT\" ` -ResourceGroupName $resourceGroup ` -ResourceProviderName \"Microsoft.Automation\" ` -ResourceType \"automationAccounts\" ` -Name \"${$automationAccount}/runbooks/${$runbookName}\" ` -ApiVersion \"2017-05-15-preview\" ` -Payload \"{`\"properties`\":{`\"runbookType`\":`\"PowerShell7`\", `\"logProgress`\":false, `\"logVerbose`\":false, `\"draft`\":{}}, `\"location`\":`\"${location}`\"}\" Invoke-AzRestMethod -Method \"PUT\" ` -ResourceGroupName $resourceGroup ` -ResourceProviderName \"Microsoft.Automation\" ` -ResourceType automationAccounts ` -Name \"${$automationAccount}/runbooks/${$runbookName}/draft/content\" ` -ApiVersion 2015-10-31 ` -Payload \"$scriptContent\" Once the PowerShell 7 Runbook has been deployed to the automation account, the standard PowerShell cmdlets can be used again, such as creating schedules.\n","wordCount":"455","inLanguage":"en","image":"https://markkerry.github.io/media/cover.png","datePublished":"2023-04-02T12:39:38Z","dateModified":"2023-04-02T12:39:38Z","author":{"@type":"Person","name":"Mark kerry"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/"},"publisher":{"@type":"Organization","name":"markkerry.github.io","logo":{"@type":"ImageObject","url":"https://markkerry.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://markkerry.github.io/ accesskey=h title="markkerry.github.io (Alt + H)">markkerry.github.io</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://markkerry.github.io/about/ title=About><span>About</span></a></li><li><a href=https://markkerry.github.io/archive title=Archive><span>Archive</span></a></li><li><a href=https://markkerry.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://markkerry.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://markkerry.github.io/posts/>Posts</a></div><h1 class=post-title>Deploy an Azure Automation Runbook With PowerShell</h1><div class=post-meta><span title='2023-04-02 12:39:38 +0000 UTC'>April 2, 2023</span>&nbsp;Â·&nbsp;3 min&nbsp;Â·&nbsp;Mark kerry</div></header><figure class=entry-cover><img loading=lazy srcset="https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/media/cover_hu44ce211cad9d7a165a3dc0c5f1660e04_24208_360x0_resize_box_3.png 360w ,https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/media/cover_hu44ce211cad9d7a165a3dc0c5f1660e04_24208_480x0_resize_box_3.png 480w ,https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/media/cover.png 663w" sizes="(min-width: 768px) 720px, 100vw" src=https://markkerry.github.io/posts/2023/04/deploy-automation-runbook-with-powershell/media/cover.png alt width=663 height=332><p>Deploy a PowerShell 5.1 & 7.1 runtime, Azure Automation Runbook, using PowerShell</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#powershell-51-runtime aria-label="PowerShell 5.1 Runtime">PowerShell 5.1 Runtime</a></li><li><a href=#powershell-71-runtime aria-label="PowerShell 7.1 Runtime">PowerShell 7.1 Runtime</a></li></ul></div></details></div><div class=post-content><p>The following will walk through the steps to deploy a PowerShell 5.1 and 7.1 runtime, Azure Automation Runbook, using PowerShell. This may be necessary if you are using a deployment script in a pipeline. There are two different methods to this depending on if you are deploying a runtime type of PowerShell 5.1 or PowerShell 7.1. If you want to use the <code>ForEach-Object -Parrallel</code> feature for example, then you will have to use PowerShell 7.1 runtime type.</p><blockquote><p><em>NOTE: At the time of writing, Microsoft does not support deploying a runbook with PowerShell 7.1 as the runtime type using PowerShell, AZ CLI, ARM or Bicep. To get around this the content of the runbook has to be posted to the automation account using the <code>Invoke-AzRestMethod</code> cmdlet.</em></p></blockquote><p>I won&rsquo;t go over creating the automation account and will assume it is already created. To create one using PowerShell see <a href=https://learn.microsoft.com/en-us/powershell/module/az.automation/new-azautomationaccount>Microsoft Docs</a>.</p><h2 id=powershell-51-runtime>PowerShell 5.1 Runtime<a hidden class=anchor aria-hidden=true href=#powershell-51-runtime>#</a></h2><p>The PowerShell 5.1 runbook can easily be created and imported using a single command. The following assumes the runbook script is in the same directory as the deployment script and the name of the file is assigned to the <code>$scriptName</code> variable. Assign the <code>$runbookName</code> variable the name of the runbook you want to create or deploy to.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$automationAccount = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$resourceGroup = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$runbookName = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$scriptName = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Import-AzAutomationRunbook `
</span></span><span style=display:flex><span>    -AutomationAccountName $automationAccount `
</span></span><span style=display:flex><span>    -Name $runbookName `
</span></span><span style=display:flex><span>    -Path $PSScriptRoot\$scriptName `
</span></span><span style=display:flex><span>    -Published `
</span></span><span style=display:flex><span>    -ResourceGroupName $resourceGroup `
</span></span><span style=display:flex><span>    -Type PowerShell
</span></span></code></pre></div><p>Although the above is well documented already, I wanted to keep it in this post as a comparison to doing for PowerShell 7.1 runtime which is not documented by Microsoft.</p><h2 id=powershell-71-runtime>PowerShell 7.1 Runtime<a hidden class=anchor aria-hidden=true href=#powershell-71-runtime>#</a></h2><p>As mentioned above the process is different and the <code>Invoke-AzRestMethod</code> cmdlet has to be used to publish a PowerShell 7.1 runtime runbook. As the script has to be posted, start by assigning the script content to a variable, create the runbook, then finally importing it. The below gives an example script assigned to the <code>$scriptContent</code> variable.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$scriptContent = <span style=color:#e6db74>@&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Ensure you do not inherit an AzContext in your runbook
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>try {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Disable-AzContextAutosave -Scope Process | Out-Null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Write-Output &#34;Logging in to Azure...&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Connect-AzAccount -Identity | Out-Null
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>catch {
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Write-Error -Message $_.Exception
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    throw $_.Exception
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Rest of script goes here...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;@</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$automationAccount = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$resourceGroup = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$runbookName = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>$location = <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-AzRestMethod -Method <span style=color:#e6db74>&#34;PUT&#34;</span> `
</span></span><span style=display:flex><span>    -ResourceGroupName $resourceGroup `
</span></span><span style=display:flex><span>    -ResourceProviderName <span style=color:#e6db74>&#34;Microsoft.Automation&#34;</span> `
</span></span><span style=display:flex><span>    -ResourceType <span style=color:#e6db74>&#34;automationAccounts&#34;</span> `
</span></span><span style=display:flex><span>    -Name <span style=color:#e6db74>&#34;${</span>$automationAccount<span style=color:#e6db74>}/runbooks/${</span>$runbookName<span style=color:#e6db74>}&#34;</span> `
</span></span><span style=display:flex><span>    -ApiVersion <span style=color:#e6db74>&#34;2017-05-15-preview&#34;</span> `
</span></span><span style=display:flex><span>    -Payload <span style=color:#e6db74>&#34;{</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>properties</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:{</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>runbookType</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>PowerShell7</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>, </span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>logProgress</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:false, </span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>logVerbose</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:false, </span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>draft</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:{}}, </span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>location</span><span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>:</span><span style=color:#ae81ff>`&#34;</span>${location}<span style=color:#ae81ff>`&#34;</span><span style=color:#e6db74>}&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Invoke-AzRestMethod -Method <span style=color:#e6db74>&#34;PUT&#34;</span> `
</span></span><span style=display:flex><span>    -ResourceGroupName $resourceGroup `
</span></span><span style=display:flex><span>    -ResourceProviderName <span style=color:#e6db74>&#34;Microsoft.Automation&#34;</span> `
</span></span><span style=display:flex><span>    -ResourceType automationAccounts `
</span></span><span style=display:flex><span>    -Name <span style=color:#e6db74>&#34;${</span>$automationAccount<span style=color:#e6db74>}/runbooks/${</span>$runbookName<span style=color:#e6db74>}/draft/content&#34;</span> `
</span></span><span style=display:flex><span>    -ApiVersion <span style=color:#ae81ff>2015</span>-<span style=color:#ae81ff>10</span>-<span style=color:#ae81ff>31</span> `
</span></span><span style=display:flex><span>    -Payload <span style=color:#e6db74>&#34;</span>$scriptContent<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>Once the PowerShell 7 Runbook has been deployed to the automation account, the standard PowerShell cmdlets can be used again, such as <a href=https://learn.microsoft.com/en-us/powershell/module/az.automation/new-azautomationschedule>creating schedules</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://markkerry.github.io/tags/azure/>Azure</a></li><li><a href=https://markkerry.github.io/tags/automation/>Automation</a></li><li><a href=https://markkerry.github.io/tags/powershell/>PowerShell</a></li></ul><nav class=paginav><a class=next href=https://markkerry.github.io/posts/2022/11/deploy-aspcore-app-to-aks/><span class=title>Next Â»</span><br><span>Deploy an ASP.NET Core Web App to an AKS Cluster</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://markkerry.github.io/>markkerry.github.io</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>